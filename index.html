<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISU EXCELLENCE AWARD Voting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .header {
            text-align: center;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header h2 {
            font-size: 1.5em;
            opacity: 0.9;
        }
        .category-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: none;
        }
        .category-container.active {
            display: block;
        }
        .category-title {
            font-size: 1.8em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .category-description {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .candidate-option {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 3px solid #e9ecef;
            transition: all 0.3s;
            cursor: pointer;
        }
        .candidate-option:hover {
            border-color: #3498db;
            background: #e3f2fd;
            transform: translateY(-3px);
        }
        .candidate-option.selected {
            border-color: #27ae60;
            background: #e8f5e8;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
            transform: translateY(-2px);
        }
        .candidate-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #3498db;
            margin-bottom: 12px;
            background: #ecf0f1;
        }
        .candidate-name {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        .candidate-country {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .nav-btn {
            background: #3498db;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        .nav-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            border-radius: 4px;
            transition: width 0.3s;
        }
        .progress-text {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        .submit-section {
            text-align: center;
            margin: 30px 0;
            display: none;
        }
        .submit-section.active {
            display: block;
        }
        .submit-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        .instructions {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 20px;
            font-size: 1.1em;
        }
        /* ADMIN STYLES */
        .admin-section {
            text-align: center;
            margin: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .admin-btn {
            background: #3498db;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .admin-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ISU EXCELLENCE AWARD</h1>
        <h2>Category-Based Voting System</h2>
    </div>

    <div class="instructions">
        <p>Vote for ONE candidate in each category. Navigate through categories using Next/Previous buttons.</p>
    </div>

    <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
    </div>
    <div class="progress-text" id="progressText">Category 1 of 38</div>

    <div id="categoriesContainer">
        <!-- Categories will be loaded here one at a time -->
    </div>

    <div class="submit-section" id="submitSection">
        <button class="submit-btn" onclick="submitVotes()">Submit All Votes</button>
    </div>

    <!-- ADMIN SECTION -->
    <div class="admin-section">
        <h3>Admin Functions</h3>
        <button onclick="viewAllVotes()" class="admin-btn">üìä View All Votes</button>
        <button onclick="viewLiveResults()" class="admin-btn" style="background: #0f9d58;">üìà View Google Sheets</button>
        <button onclick="clearAllVotes()" class="admin-btn" style="background: #e74c3c;">üóëÔ∏è Clear All Votes</button>
    </div>

    <script>
        // Google Sheets configuration
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbws6RmxVDl0deQPMiTGDTt5sonrbyEcowObvS5qgxLGxAApTNWG5d5KEtyUbW9YO92y0Q/exec';

        // Award categories
        const awardCategories = [
            "ISU Executive Board Member of the Year",
            "Most Dedicated Volunteer",
            "Outstanding Cultural Event of the Year",
            "International Students Athletes of the Year (Football, Volleyball, Basketball)",
            "Art & Creative Award",
            "Best Teacher of the Year",
            "Most Talented Award",
            "Most Popular Award (Male)",
            "Most Popular Award (Female)",
            "Most Active Award",
            "Best Behavior Award",
            "Best Cleaning Room Award",
            "Best Coach Award",
            "Best Student dancing Award",
            "Best Photographer award",
            "Student MC of the Year",
            "Best Course REP of the Year (Male)",
            "Best Course REP of the Year (Female)",
            "Best Artist of the Year",
            "Student Entrepreneur of the year",
            "Outstanding graphic designer of the year",
            "Gentlemen of the Year",
            "Lady of the Year",
            "Most fashionable Student (Male)",
            "Most fashionable Student (Female)",
            "Social Media Influencer of the year",
            "Most influential Student of the Year",
            "Best sports personality of the year",
            "Best Student in Politics of the year",
            "Best ISU appointees",
            "ISU Excellent Award",
            "Most influential personality of Football, Basketball, and volleyball",
            "Class Football Team of the year",
            "Committee/ Department Head of the year",
            "Best Initiative Award",
            "Academic Excellent Award (Undergraduate)",
            "Academic Excellent Award (Graduate)",
            "International Office Appreciation Award"
        ];

        // Candidate data
        const candidates = [
            { name: "EL-KHADIRI MERYEME", country: "Morocco", photo: "photos/EL-KHADIRI_MERYEME.jpg", positions: [0,8,17,20,30,35,37] },
            { name: "Michelle Okyerebea Asante", country: "GHANA", photo: "photos/Michelle_Okyerebea_Asante.jpg", positions: [1,8,9,10,11,19,22,25] },
            { name: "Kundayi Nigel Ndoro", country: "ZIMBABWE", photo: "photos/Kundayi_Nigel_Ndoro.jpg", positions: [12,27,31] },
            { name: "BERRADA SOUHAIL", country: "MOROCCO", photo: "photos/BERRADA_SOUHAIL.jpg", positions: [15,21,23] },
            { name: "NIGINA", country: "KAZAKHISTAN", photo: "photos/NIGINA.jpg", positions: [8,25] },
            { name: "Zulfiddin Mehriddinov", country: "UZBEKISTAN", photo: "photos/Zulfiddin_Mehriddinov.jpg", positions: [3,31] },
            { name: "MUHAMMADOV MUHAMMAD SODIK", country: "UZBEKISTAN", photo: "photos/MUHAMMADOV_MUHAMMAD_SODIK.jpg", positions: [27,31] },
            { name: "Diaby Khadjaly", country: "GUINEA", photo: "photos/Diaby_Khadjaly.jpg", positions: [14,20,21,30] },
            { name: "Wisdom Chisom", country: "Nigeria", photo: "photos/Wisdom_Chisom.jpg", positions: [23] },
            { name: "Kra Kouassi Fedi", country: "Guinea", photo: "photos/Kra_Kouassi_Fedi.jpg", positions: [31] },
            { name: "Izzatullaev Musulmon", country: "UZBEKISTAN", photo: "photos/Izzatullaev_Musulmon.jpg", positions: [1,9,10] },
            { name: "Watson Karanda", country: "ZIMBABWE", photo: "photos/Watson_Karanda.jpg", positions: [19] },
            { name: "Eze Victor", country: "Nigeria", photo: "photos/Eze_Victor.jpg", positions: [19,23] },
            { name: "Keita Fatumata S", country: "Liberia", photo: "photos/Keita_Fatumata_S.jpg", positions: [15] },
            { name: "Elma Taimu", country: "Zimbabwe", photo: "photos/Elma_Taimu.jpg", positions: [13] },
            { name: "Marygold Vimbainashe", country: "ZIMBABWE", photo: "photos/Marygold_Vimbainashe.jpg", positions: [3,31] },
            { name: "Khoshimov M", country: "UZBEKISTAN", photo: "photos/Khoshimov_M.jpg", positions: [27,31] },
            { name: "Anika Jannatul Ferdush", country: "BANGLADESH", photo: "photos/Anika_Jannatul_Ferdush.jpg", positions: [1,2,8,9,11,13,22,26,30,34] },
            { name: "Serhani Anass", country: "MOROCCO", photo: "photos/Serhani_Anass.jpg", positions: [3,27,31] },
            { name: "Andrew Stephen W", country: "CAMEROON", photo: "photos/Andrew_Stephen_W.jpg", positions: [3,27,31] },
            { name: "Matola Kenny Jerre", country: "South Africa", photo: "photos/Matola_Kenny_Jerre.jpg", positions: [3] },
            { name: "Karshygayeva Aiym", country: "KAZAKHISTAN", photo: "photos/Karshygayeva_Aiym.jpg", positions: [6,8,26,36] },
            { name: "Chatir Soukaina", country: "MOROCCO", photo: "photos/Chatir_Soukaina.jpg", positions: [11,22,27,35] },
            { name: "Duru Valentine Obinna", country: "Nigeria", photo: "photos/Duru_Valentine_Obinna.jpg", positions: [7] },
            { name: "Say Kong Tharak", country: "CAMBODIA", photo: "photos/Say_Kong_Tharak.jpg", positions: [2,11] },
            { name: "Ork Chanchutema", country: "CAMBODIA", photo: "photos/Ork_Chanchutema.jpg", positions: [10,36] },
            { name: "Kong Mengsean", country: "CAMBODIA", photo: "photos/Kong_Mengsean.jpg", positions: [2,8,9,35,37] },
            { name: "Clarmancio Nilton Silva Fernandes", country: "Mozambique", photo: "photos/Clarmancio_Nilton_Silva_Fernandes.jpg", positions: [3,27] },
            { name: "Fixa", country: "MOROCCO", photo: "photos/Fixa.jpg", positions: [25] },
            { name: "MAMAYUSUPOV ILKHOM", country: "Uzbekistan", photo: "photos/MAMAYUSUPOV_ILKHOM.jpg", positions: [27,31] },
            { name: "Shaun Nkosinathi NG", country: "South Africa", photo: "photos/Shaun_Nkosinathi_NG.jpg", positions: [18] },
            { name: "AIT BAHMED FOUZIA", country: "MOROCCO", photo: "photos/AIT_BAHMED_FOUZIA.jpg", positions: [5,6,10,12,22,27,35] },
            { name: "LUPAHLA SANELE", country: "Zimbabwe", photo: "photos/LUPAHLA_SANELE.jpg", positions: [3,8,9,11,27] },
            { name: "OFFOR UCHECHI ROSELINE", country: "Nigeria", photo: "photos/OFFOR_UCHECHI_ROSELINE.jpg", positions: [11] },
            { name: "OUSSOUSS HAMID", country: "MOROCCO", photo: "photos/OUSSOUSS_HAMID.jpg", positions: [2,6,14] },
            { name: "SOT FA ELIN", country: "CAMBODIA", photo: "photos/SOT_FA_ELIN.jpg", positions: [0,4,9,11,14,20,25,28,30] },
            { name: "ORA", country: "Rwanda", photo: "photos/ORA.jpg", positions: [11] },
            { name: "PHIRI EMMANUEL", country: "Zambia", photo: "photos/PHIRI_EMMANUEL.jpg", positions: [1,10] },
            { name: "COMPUTER SCIENCE", country: "", photo: "photos/COMPUTER_SCIENCE.jpg", positions: [32] },
            { name: "Mozumder Aktia Pableha", country: "BANGLADESH", photo: "photos/Mozumder_Aktia_Pableha.jpg", positions: [1] },
            { name: "Bekkaoui Souhaib", country: "Morocco", photo: "photos/Bekkaoui_Souhaib.jpg", positions: [4,13,23,28,34] },
            { name: "TOURE FRED RYAN", country: "Ivory Coast", photo: "photos/TOURE_FRED_RYAN.jpg", positions: [11,32] },
            { name: "KUNGNE KALEUK STEEVE JOSUE", country: "Cameroon", photo: "photos/KUNGNE_KALEUK_STEEVE_JOSUE.jpg", positions: [1,35] },
            { name: "Naphtali Antonio", country: "", photo: "photos/Naphtali_Antonio.jpg", positions: [14] }
        ];

        let currentCategoryIndex = 0;
        let votes = {};

        // Generate unique voter ID
        function generateVoterId() {
            let voterId = localStorage.getItem('isu_voterId');
            if (!voterId) {
                voterId = 'voter_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('isu_voterId', voterId);
            }
            return voterId;
        }

        // Load current category
        function loadCurrentCategory() {
            const container = document.getElementById('categoriesContainer');
            const category = awardCategories[currentCategoryIndex];
            
            // Get candidates who applied for this category
            const categoryCandidates = candidates.filter(candidate => 
                candidate.positions.includes(currentCategoryIndex)
            );

            container.innerHTML = `
                <div class="category-container active">
                    <div class="category-title">${category}</div>
                    <div class="category-description">
                        Select ONE winner from ${categoryCandidates.length} candidate(s)
                    </div>
                    
                    <div class="candidates-grid">
                        ${categoryCandidates.map((candidate, index) => `
                            <div class="candidate-option" onclick="selectCandidate(${currentCategoryIndex}, '${candidate.name}')">
                                <img src="${candidate.photo}" alt="${candidate.name}" class="candidate-photo" 
                                     onerror="this.src='https://via.placeholder.com/120x120/3498db/white?text=Photo'">
                                <div class="candidate-name">${candidate.name}</div>
                                <div class="candidate-country">${candidate.country}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="navigation">
                        <button class="nav-btn" onclick="previousCategory()" ${currentCategoryIndex === 0 ? 'disabled' : ''}>
                            ‚Üê Previous
                        </button>
                        <button class="nav-btn" onclick="nextCategory()">
                            ${currentCategoryIndex === awardCategories.length - 1 ? 'Finish' : 'Next ‚Üí'}
                        </button>
                    </div>
                </div>
            `;

            // Update progress
            updateProgress();
            
            // Show selected candidate if any
            if (votes[currentCategoryIndex]) {
                highlightSelectedCandidate(currentCategoryIndex, votes[currentCategoryIndex]);
            }
        }

        // Select candidate for category
        function selectCandidate(categoryIndex, candidateName) {
            votes[categoryIndex] = candidateName;
            highlightSelectedCandidate(categoryIndex, candidateName);
            updateProgress();
        }

        // Highlight selected candidate
        function highlightSelectedCandidate(categoryIndex, candidateName) {
            const options = document.querySelectorAll('.candidate-option');
            options.forEach(option => {
                option.classList.remove('selected');
                if (option.querySelector('.candidate-name').textContent === candidateName) {
                    option.classList.add('selected');
                }
            });
        }

        // Navigation functions
        function nextCategory() {
            if (currentCategoryIndex < awardCategories.length - 1) {
                currentCategoryIndex++;
                loadCurrentCategory();
            } else {
                showSubmitSection();
            }
        }

        function previousCategory() {
            if (currentCategoryIndex > 0) {
                currentCategoryIndex--;
                loadCurrentCategory();
            }
        }

        // Update progress
        function updateProgress() {
            const votedCount = Object.keys(votes).length;
            const progress = (votedCount / awardCategories.length) * 100;
            
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = 
                `Category ${currentCategoryIndex + 1} of ${awardCategories.length} ‚Ä¢ ${votedCount}/${awardCategories.length} voted`;
        }

        // Show submit section
        function showSubmitSection() {
            document.getElementById('submitSection').classList.add('active');
        }

        // Submit votes
        async function submitVotes() {
            const totalVotes = Object.keys(votes).length;
            
            if (totalVotes === 0) {
                alert('Please vote in at least one category before submitting.');
                return;
            }

            // Save to Google Sheets
            let successCount = 0;
            for (const [categoryIndex, candidateName] of Object.entries(votes)) {
                const success = await saveVoteToSheet(awardCategories[categoryIndex], candidateName);
                if (success) successCount++;
            }

            // Save to localStorage
            localStorage.setItem('isu_votes', JSON.stringify(votes));
            
            if (successCount === totalVotes) {
                alert(`‚úÖ Success! ${totalVotes} votes submitted to official records!`);
            } else {
                alert(`‚ö†Ô∏è ${successCount}/${totalVotes} votes recorded. Some votes saved locally.`);
            }
            
            // Reset for next voter
            votes = {};
            currentCategoryIndex = 0;
            loadCurrentCategory();
            document.getElementById('submitSection').classList.remove('active');
        }

        // Save vote to Google Sheets
        async function saveVoteToSheet(category, candidate) {
            const voteData = {
                voterId: generateVoterId(),
                category: category,
                candidate: candidate,
                userAgent: navigator.userAgent
            };
            
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(voteData)
                });
                return true;
            } catch (error) {
                console.error('Failed to save vote:', error);
                return false;
            }
        }

        // Admin functions
        function viewAllVotes() {
            const savedVotes = JSON.parse(localStorage.getItem('isu_votes')) || {};
            if (Object.keys(savedVotes).length === 0) {
                alert('No votes have been collected yet.');
                return;
            }
            
            let results = "VOTE RESULTS:\n\n";
            Object.entries(savedVotes).forEach(([categoryIndex, candidate]) => {
                results += `üèÜ ${awardCategories[categoryIndex]}: ${candidate}\n`;
            });
            alert(results);
        }

        function viewLiveResults() {
            window.open('https://docs.google.com/spreadsheets/d/1GeiFcvRSwdyUa5Xak4LjfwLA1M-6313gR0YPcpm3Hk4/edit', '_blank');
        }

        function clearAllVotes() {
            if (confirm('‚ö†Ô∏è ARE YOU SURE? This will delete ALL collected votes permanently!')) {
                localStorage.removeItem('isu_votes');
                localStorage.removeItem('isu_voterId');
                votes = {};
                alert('All votes have been cleared.');
            }
        }

        // Initialize
        window.addEventListener('load', function() {
            // Load saved votes
            const savedVotes = JSON.parse(localStorage.getItem('isu_votes')) || {};
            votes = savedVotes;
            
            loadCurrentCategory();
            updateProgress();
        });
    </script>
</body>
</html>


